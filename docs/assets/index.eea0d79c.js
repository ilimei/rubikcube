import{C as A,B as I,a as v,b as B,c as x,I as P,V as C,d as T,M as S,e as d,f as V,Q as N,S as X,W as Y,g as U,O as Z,h as _,i as G,j as H,R as K,k as R,H as Q,L as W,l as M,m as k}from"./vendor.14aa78e1.js";const j=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function o(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerpolicy&&(c.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?c.credentials="include":t.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(t){if(t.ep)return;t.ep=!0;const c=o(t);fetch(t.href,c)}};j();function g(a){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return new A(parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,1)}const q=[g("#C41E3A"),g("#009E60"),g("#0051BA"),g("#FF5800"),g("#FFD500"),g("#FFFFFF")];function $(a,e,o){const n=new I(a,"CustomCubeGeometry"),t=e-o,c=new Float32Array([-t,e,-t,0,1,0,t,e,-t,0,1,0,t,e,t,0,1,0,-t,e,t,0,1,0,-t,-e,-t,0,-1,0,t,-e,-t,0,-1,0,t,-e,t,0,-1,0,-t,-e,t,0,-1,0,-e,t,-t,-1,0,0,-e,t,t,-1,0,0,-e,-t,t,-1,0,0,-e,-t,-t,-1,0,0,e,t,-t,1,0,0,e,t,t,1,0,0,e,-t,t,1,0,0,e,-t,-t,1,0,0,-t,t,e,0,0,1,t,t,e,0,0,1,t,-t,e,0,0,1,-t,-t,e,0,0,1,-t,t,-e,0,0,-1,t,t,-e,0,0,-1,t,-t,-e,0,0,-1,-t,-t,-e,0,0,-1,-t,e,-t,-1,1,-1,-e,t,-t,-1,1,-1,-t,t,-e,-1,1,-1,-t,-e,-t,-1,-1,-1,-e,-t,-t,-1,-1,-1,-t,-t,-e,-1,-1,-1,t,e,-t,1,1,-1,e,t,-t,1,1,-1,t,t,-e,1,1,-1,t,-e,-t,1,-1,-1,e,-t,-t,1,-1,-1,t,-t,-e,1,-1,-1,-t,e,t,-1,1,1,-e,t,t,-1,1,1,-t,t,e,-1,1,1,-t,-e,t,-1,-1,1,-e,-t,t,-1,-1,1,-t,-t,e,-1,-1,1,t,e,t,1,1,1,e,t,t,1,1,1,t,t,e,1,1,1,t,-e,t,1,-1,1,e,-t,t,1,-1,1,t,-t,e,1,-1,1,-t,e,-t,-1,1,0,-t,e,t,-1,1,0,-e,t,-t,-1,1,0,-e,t,t,-1,1,0,t,e,-t,1,1,0,t,e,t,1,1,0,e,t,-t,1,1,0,e,t,t,1,1,0,-t,e,t,0,1,1,t,e,t,0,1,1,-t,t,e,0,1,1,t,t,e,0,1,1,-t,e,-t,0,1,-1,t,e,-t,0,1,-1,-t,t,-e,0,1,-1,t,t,-e,0,1,-1,-t,-e,-t,-1,-1,0,-t,-e,t,-1,-1,0,-e,-t,-t,-1,-1,0,-e,-t,t,-1,-1,0,t,-e,-t,1,-1,0,t,-e,t,1,-1,0,e,-t,-t,1,-1,0,e,-t,t,1,-1,0,-t,-e,t,0,-1,1,t,-e,t,0,-1,1,-t,-t,e,0,-1,1,t,-t,e,0,-1,1,-t,-e,-t,0,-1,-1,t,-e,-t,0,-1,-1,-t,-t,-e,0,-1,-1,t,-t,-e,0,-1,-1,-e,t,t,-1,0,1,-e,-t,t,-1,0,1,-t,t,e,-1,0,1,-t,-t,e,-1,0,1,t,t,e,1,0,1,t,-t,e,1,0,1,e,t,t,1,0,1,e,-t,t,1,0,1,e,t,-t,1,0,-1,e,-t,-t,1,0,-1,t,t,-e,1,0,-1,t,-t,-e,1,0,-1,-t,t,-e,-1,0,-1,-t,-t,-e,-1,0,-1,-e,t,-t,-1,0,-1,-e,-t,-t,-1,0,-1]),u=new Uint16Array([0,2,1,2,0,3,4,6,7,6,4,5,8,10,9,10,8,11,12,14,15,14,12,13,16,18,17,18,16,19,20,22,23,22,20,21,24,26,25,27,28,29,30,31,32,33,35,34,36,37,38,39,41,40,42,44,43,45,46,47,48,50,49,50,51,49,52,53,54,55,54,53,56,58,57,58,59,57,60,61,62,62,61,63,64,65,66,66,65,67,68,70,69,71,69,70,72,73,74,75,74,73,76,78,77,79,77,78,80,81,82,83,82,81,84,85,86,87,86,85,88,89,90,91,90,89,92,93,94,95,94,93]),i=new Float32Array(3*24+3*24+3*32+3*16);i.fill(0);for(let b=0;b<6;b++){const s=q[b],h=b*12;for(let l=0;l<4;l++)i[h+l*3+0]=s.r,i[h+l*3+1]=s.g,i[h+l*3+2]=s.b}const m=new v(a,B.VertexBuffer,c,x.Static),y=new v(a,B.IndexBuffer,u,x.Static),w=new v(a,B.VertexBuffer,i,x.Dynamic);return n.setVertexBufferBinding(m,24),n.setIndexBufferBinding(y,P.UInt16),n.setVertexBufferBinding(w,12,1),n.setVertexElements([new C("POSITION",0,T.Vector3,0),new C("NORMAL",12,T.Vector3,0),new C("COLOR_0",0,T.Vector3,1)]),n.addSubMesh(0,u.length,S.Triangles),n}const F=1,J=1/20,z=3,tt=2;function D(a,e){return Math.abs(a-e)<1e-4}var f;(function(a){a.UP="UP",a.DOWN="DOWN",a.LEFT="LEFT",a.RIGHT="RIGHT",a.FRONT="FRONT",a.BACK="BACK"})(f||(f={}));class r{}r.X=new d(1,0,0);r.DX=new d(-1,0,0);r.Y=new d(0,1,0);r.DY=new d(0,-1,0);r.Z=new d(0,0,1);r.DZ=new d(0,0,-1);class et{constructor(){this.start=!1,this.angle=0}get radians(){return this.angle*Math.PI/180}updateDir(){const{point:e}=this,o=z*F/2,n=.001,t=Math.abs(Math.abs(e.x)-o),c=Math.abs(Math.abs(e.y)-o),u=Math.abs(Math.abs(e.z)-o);return t<n?e.x>0?f.RIGHT:f.LEFT:c<n?e.y>0?f.UP:f.DOWN:u<n&&e.z>0?f.BACK:f.FRONT}updateRotation(){const{x:e,y:o,z:n}=this.endPos.clone().subtract(this.startPos);switch(this.dir){case f.UP:return Math.abs(e)>Math.abs(n)?e>0?r.DZ:r.Z:n>0?r.X:r.DX;case f.DOWN:return Math.abs(e)>Math.abs(n)?e>0?r.Z:r.DZ:n>0?r.DX:r.X;case f.LEFT:return Math.abs(o)>Math.abs(n)?o>0?r.DZ:r.Z:n>0?r.Y:r.DY;case f.RIGHT:return Math.abs(o)>Math.abs(n)?o>0?r.Z:r.DZ:n>0?r.DY:r.Y;case f.FRONT:return Math.abs(e)>Math.abs(o)?e>0?r.DY:r.Y:o>0?r.X:r.DX;case f.BACK:return Math.abs(e)>Math.abs(o)?e>0?r.Y:r.DY:o>0?r.DX:r.X}}startMove(e){this.dir=this.updateDir(),this.rotation=this.updateRotation();const o=this.entity;this.entity.transform.setPosition,this.cubes=e.filter(n=>this.rotation===r.X||this.rotation===r.DX?D(n.transform.position.x,o.transform.position.x):this.rotation===r.Y||this.rotation===r.DY?D(n.transform.position.y,o.transform.position.y):D(n.transform.position.z,o.transform.position.z)),this.rotationQuaternions=this.cubes.map(n=>n.transform.rotationQuaternion.clone()),this.positions=this.cubes.map(n=>n.transform.position.clone()),this.start=!0}update(){this.angle+=tt,this.angle>90&&(this.angle=90,this.start=!1),this.cubes.forEach((e,o)=>{const n=new V,t=this.positions[o].clone(),c=this.rotationQuaternions[o].clone(),{x:u,y:i,z:m}=t;n.translate(new d(-u,-i,-m)),n.rotateAxisAngle(this.rotation,this.radians),n.translate(new d(u,i,m)),e.transform.position=t.transformNormal(n);const y=new N;y.rotateAxisAngle(this.rotation,this.radians),e.transform.rotationQuaternion=y.multiply(c)})}}class nt extends X{constructor(){super(...arguments);this.cubes=[]}set control(e){this._control=e}get control(){return this._control}onStart(){this.cubes=this.entity.children.filter(e=>e.name==="cube")}onUpdate(){this.currentMove&&this.currentMove.start&&this.currentMove.update()}click(e,o,n){var t;((t=this.currentMove)==null?void 0:t.start)||(this.currentMove=new et,this.currentMove.entity=e,this.currentMove.point=o,this.currentMove.startPos=n,this.control.enableRotate=!1)}mouseup(e){var o;!this.control.enableRotate&&!((o=this.currentMove)==null?void 0:o.start)&&(this.currentMove.endPos=e,this.currentMove.startMove(this.cubes)),this.control.enableRotate=!0}}window.Vector3=d;function rt(){const a=new Y("canvas");a.canvas.resizeByClientSize();const e=a.sceneManager.activeScene,o=e.createRootEntity(),n=o.addComponent(nt),t=o.createChild("camera"),c=t.addComponent(U);n.control=t.addComponent(Z),n.control.enablePan=!1;const u=t.transform.position;u.setValue(10,10,10),t.transform.position=u,t.transform.lookAt(new d(0,0,0)),e.ambientLight.diffuseSolidColor.setValue(1,1,1,1),e.ambientLight.diffuseIntensity=1.2;const i=F;for(let s=-1;s<2;s++)for(let h=-1;h<2;h++)for(let l=-1;l<2;l++){const p=o.createChild("cube"),E=p.transform.position;E.setValue(s*i,h*i,l*i),p.transform.position=E,p.addComponent(_).setBoxCenterSize(new d,new d(i,i,i));const O=p.addComponent(G),L=new H(a);O.mesh=$(a,i/2,J),O.setMaterial(L)}const m=new K,y=window.devicePixelRatio;function w(s){let h=s.offsetX,l=s.offsetY;s.touches&&s.touches.length>0&&(h=s.touches[0].pageX,l=s.touches[0].pageY),c.screenPointToRay(new R(h,l).scale(y),m);const p=new Q;a.physicsManager.raycast(m,Number.MAX_VALUE,W.Everything,p)&&n.click(p.collider.entity,p.point,m.direction.clone())}function b(s){let h=s.offsetX,l=s.offsetY;s.changedTouches&&s.changedTouches.length>0&&(h=s.changedTouches[0].pageX,l=s.changedTouches[0].pageY),c.screenPointToRay(new R(h,l).scale(y),m),n.mouseup(m.direction.clone())}document.getElementById("canvas").addEventListener("mousedown",w),document.getElementById("canvas").addEventListener("mouseup",b),document.getElementById("canvas").addEventListener("touchstart",w),document.getElementById("canvas").addEventListener("touchend",b),a.run()}function ot(){return M.useEffect(()=>{rt()},[]),M.createElement("canvas",{id:"canvas",style:{width:"100vw",height:"100vh"}})}k.render(M.createElement(M.StrictMode,null,M.createElement(ot,null)),document.getElementById("root"));
